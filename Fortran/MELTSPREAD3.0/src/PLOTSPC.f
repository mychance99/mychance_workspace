C...................................................................... 
C.....SUBROUTINE PLOTSPC SAVES THE SPATIALLY DEPENDENT SPREADING DATA 
C.....AT USER-SPECIFIED TIMES.
C...................................................................... 
      SUBROUTINE PLOTSPC(KPL)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      COMMON/PRINTR/ QFEH2O,QCRH2O,QZRH2O,QFECO2,QCRCO2,QZRCO2,
     4XFH2OU,XFCAOH,XFMGCA,XFCACO,XZRMRE,XFEMRE,XCRMRE,XZRORE,XFEORE,   
     5XCRORE,XMH2O,XMCO2,XMCACO,XMMGCA,XMCAOH,TFWL,TFWS,TBWL,TBWS,      
     6TMCAL,TMCAS,TCAL,TCAS,TFOS,TFOL,TFMS,TFML,XVISC(28),SVISC(28),    
     7XMOL(28),FMMOL(28),ROM(28),ROMLIQ(28),AEQM(28,2),BEQM(28,2),
     8CEQM(28,2),ECL,ECS,ECAL,ECAS,EMCAL,EMCAS,EBWL,EBWS,EFWL,EFWS,    
     9STEF,GRAV,PI,TCS,TCL,CCL,CCS,RMASSL,WPCC,WPM,WPA,WPCS,ROC,RMASSS,   
     1ANGSHL,RSLAGL,RSLAGS,HNODT,VFAV,VGAV,QXAV,XWTSS(16),  
     2TSCS(2),TSCL(2),ESCS(2),ESCL(2),CCSS(2),CCSL(2),ROSTLS,ROSTLL,
     3XFRGAS,HMINC,TST(99),TSTOP(99),AINTP(99),BINTP(99),DRATIO(999),
     4XBCN(999),XDCN(999),XBLT(15),ADEC(99),BDEC(99),APOUR(16,99),
     5BPOUR(16,99),XWTC(14),BWIDTH,THCKCV,TMBOIL,TEBOIL,VFINT,ANGFAN,
     6ALPMAX,THSHL,XFCABL,XNDMIN,DVMX,DAVMX,DEAVMX,DEMX,TDC,QDCU,QDCUO2,
     7TSINJ,EINJ,DTINJ,TKINJ,ROEV,CPINJ,SURFT,VSINJ,EMINJ,TSINJO,EINJO,
     8DTINJO,TKINJO,ROEVO,CPINJO,SURFTO,VSINJO,EMINJO,XLEADE,ARSUM,
     9DBUBOX,UTRISE,TREMSH,DJET,DFALL,WEBER,FROUDE,XPSAITO,XPEPSTN,
     1FRAG,XMBEDT,XMBED(16),XLPENT,XLPENA,UJET,UFALL,HFALL,ERPV,
     2TJETT(99),DJETT(99),HWATP,XDOTJET,DVMXW,DAVMXW,DEMXW,DEAVMXW,
     3QJETW,XSTMJF,TINTSJF,ESAT,DRDOOR,DRANL,EI,QDCBUO2,QDCBU,
     4EBEDS,EBEDB
      COMMON/PRINTB/ELEVAT(999),ELOLD(999),XDIST(999,999),XBTW(999,999),
     1TEMP(999,999),ENTHP(999,999),EOLD(999,999),ENBLK(999),EBKOLD(999),
     2TBULK(999),HITE(16,999),HITOLD(16,999),HTOT(999),HTOLD(999),
     3HTCFT(999),HTCOEF(999),QFLUXT(999),QFLUXB(999),VEL(999),ELO(999),
     4VELOLD(999),SRSCOR(16),AREA(999),RAD(999),ARC(999),VOLCN(16),
     5VOID(999),VGJ(999),ZABLAT(999),ZABOLD(999),DCRUST(999),
     6DCROLD(999),DABCON(999),DABOLD(999),DFILMT(999),DFOLT(999),
     7SMFLX(4,999),XLSMF(4,999),TOTVOL,XFACMS(999),XMFLXA,XMCORT,
     8VCORT,TOTOX,TOTMET,QFLXT,QFLXB,TIME,DTIME,XMCOR(16),VCOR(16),
     9TCONI,RSAND,HDOWNC,TBOUND,EMISCN,PDRYWL,XDISTO(999),QOXT(999),
     1XLENSH,XBTWO(999),RCOMP,WDOOR,RSUMP,RSHELL,RPED,TPED,ELSMP,
     1TENDP(10,999),TFRZSH,TDEBRS,TKDEBR,PDEBR,CPDEBR,ENENDP(10,999),
     2ENOLDP(10,999),DXVERT,DXSNK,XDSTE(10,999),XBTE(10,999),HXLA(999),
     3HXLB(999),TSFEB(999),DCRS(999),DCRSLD(999),HCRS(16,999),
     4HCRSLD(16,999),THETE0(10,999),THETE1(10,999),QSHELL,QSHELE,TSHELI,
     5SIGOXE(999),FKOXE(999),RINJC,XLSEC,ANGSEC,ANINJC,XLCHAN,WCHNL,
     6TEFZX(999),TIMSPC(999),DXNODE(999),TNORM(999),FRCSOL(999),
     7ALPSPR(999),CRAMCON,HINTF,TSHLMX,XFRMX(999),XFROX(999),XFRTX(999),
     8XMLMX(999),XMLOX(999),XMLTX(999),XTOTX(999),TIMEO,TMAX,EDOWN(999),
     9HCP(999)
      COMMON/HCONS/HMETAL(999),HOXIDE(999)  
      COMMON/PROPI/ NMATC,NMATFI,NMATFF,ICAOH2,ICACO3,IMCCO3,IFH2O,     
     1IVH2O,ICK2O,IVK2O,INA2O,ITIO2,ISIO2,ICAO,IMGO,IAL2O3,IFEO,IFE2O3, 
     2IFE3O4,IFE,ICR,INI,IZR,IU,IB4C,IB,ICR2O3,INIO,IUO2,IZRO2,IB2O3,   
     3NBCINT(999),NODES(999),NUMNOD,IMOX(28),IBAS,ILCS,ILL,NACTIV(999),     
     4NBFRZM,NBFRZO,NABLFM,NDRNFM,NTYPMT(999,999),NDOOR,NBMADJ,NUMSHV,   
     5NBSHL(999),NCRSTS(999),NUMSHH,NSKIPE,NACSH,NWAT,NPEND,NBCBOT,
     6NCRTOP,NBFZOE,NBFZME,NGEOM,NL(999,999),NFRSCT,NLOGSH,NADAB,NINVIS,
     7NSIMST,NSTEEL,NOVHT,NOVTK,NOVUM,NOVEM,NOVSIG,NPLLOC(999),NBPL,
     8IXP(999),IYP(999),NVTPE,NSOLTP,NSOLF,NINTF,IFLGA(999),ICTYPE,ICTC,
     9NPOURS,NSMP,NPED,NDOR,NSHL,NANULS,NSMPCV,NBOIL,NSWALL,NMVER,
     1NCRTEM,NTHINC,NVELP,NITMAX,NENMAX,NPRINT,NPFREQ,NTIMSPC,NPLFREQ,
     2NPLTOT,NJET,NJETP,NJETD,NJETND,NODCAP,NVELPW,NITMAXW,NENMXW,
     3IFLGJ(999),NBEDCQ,ISHELE
      COMMON /WATVARS/FCRUST(999),VLW(999),VLWOLD(999),DWAT(999),
     1DWATOLD(999),EWAT(999),EWATOLD(999),TWAT(999),CORDDC(999),
     2DSRDC(999),DHDC(999),TSRDC,TINTDC,HWATB(999),TSURFW(999),XMS(999),
     3XMST,XINTS,ESRDTW(999),TSRDTW(999),DSRDTW(999),TSRDW,TINTDW,
     4TWATI,ELDCO(999),ELDCX(999,99),CRDCX(999,99),TIMINJ(999,99),
     5XDTINJ(999,99),TDTINJ(999,99),ELWATI,XMWAT,XMWATO,XBALW,
     6HDRY(999),EINTW,XMCT(199),XMCDT(16,999),TMPCDT(999),CMPCDT(999),
     7FDC(999),FCOV(999),FBED(999),FHEAT(999),XFACJ(999),
     8XMBEDJ(16,999),XMBEDJT(999),PBED,QBED(999),QWATER(999),
     9QSURFACE(999),QWATERT(999),HBED(999),POROSBED,XMCRDT(16,999),
     1XMCRT(999),XMBDINT(999),XMT(999)
      COMMON/PROPM/DTDEM(999),CPMLT(999),FKMLT(999),DENMLT(999),
     1SIGMLT(999),UMMLT(999),EMIMLT(999)      
      DATA CENT /100.D0/
      DATA XMILL /1000.D0/
      IUNIT=9+KPL
      NACPLT=0
      DO 899 KDP=1,NUMNOD
      IF(NACTIV(KDP).EQ.1) NACPLT=NACPLT+1
  899 CONTINUE
      WRITE(IUNIT,3555) TIME
 3555 FORMAT(E12.5)
      DO 3557 KN=1,NUMNOD
      DA=CENT*(ELO(KN)-DABCON(KN))
      DC=CENT*DCRUST(KN)
      DF=CENT*DFILMT(KN)
      EN=1.D-6*ENBLK(KN)
      HM=CENT*HMETAL(KN)
      HO=CENT*HOXIDE(KN)
      HT=CENT*HTOT(KN)
      DW=CENT*DWAT(KN)
      HTV=HT/(1.D0-VOID(KN))
      EL=CENT*ELEVAT(KN)
      HTP=EL+HTV
      HTPC=EL+HT
      HTPCB=HTPC+CENT*HBED(KN)
      HWPC=DW+HTPC
      VG=CENT*VGJ(KN)
      QT=1.D-3*QFLUXT(KN)
      QB=1.D-3*QFLUXB(KN)
      QO=1.D-3*QOXT(KN)
      VL=VEL(KN)*CENT      
      DX1=RAD(KN)-0.5*DXNODE(KN)
      DX2=RAD(KN)+0.5*DXNODE(KN)
      WRITE(IUNIT,3556) DX1,EL,DA,HTPC,HWPC,HTPCB,TBULK(KN),HM,HO,HT,
     1 HTV,HTP,VOID(KN),VG,TEMP(1,KN),VL,QT,QB,QO,DC,DF,
     2 UMMLT(KN),XFRMX(KN),XFROX(KN),XMBDINT(KN),XFRTX(KN),
     3 XMLMX(KN),XMLOX(KN),XMLTX(KN),XTOTX(KN)
      WRITE(IUNIT,3556) DX2,EL,DA,HTPC,HWPC,HTPCB,TBULK(KN),HM,HO,HT,
     1 HTV,HTP,VOID(KN),VG,TEMP(1,KN),VL,QT,QB,QO,DC,DF,
     2 UMMLT(KN),XFRMX(KN),XFROX(KN),XMBDINT(KN),XFRTX(KN),
     3 XMLMX(KN),XMLOX(KN),XMLTX(KN),XTOTX(KN)
 3556 FORMAT(E12.5,29(1X,E12.5))     
 3557 CONTINUE
C.....WRITE OUT SHELL HEATUP DATA IF ACTIVATED
      IF(NSKIPE.EQ.0.OR.NACSH.EQ.0) GO TO 69
      IF(ISHELE.EQ.1) GO TO 69
      IU2=99+KPL
      NPH=NUMSHH    
      WRITE(IU2,*) TIME
      EV=1.5D0*DXVERT+FLOAT(NPEND-1)*DXVERT
      DO 88 KV=2,NPEND+1
      ID=NPEND+3-KV   
      DP=XMILL*DCRS(ID)
      EV=EV-DXVERT    
      IF(NPH.EQ.3) WRITE(IU2,71) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.4) WRITE(IU2,72) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.5) WRITE(IU2,73) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.6) WRITE(IU2,74) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.7) WRITE(IU2,75) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.8) WRITE(IU2,76) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.9) WRITE(IU2,77) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.EQ.10) WRITE(IU2,78) EV,DP,(TENDP(I,ID),I=1,NPH)
      IF(NPH.GT.10) WRITE(IU2,*) EV,DP,(TENDP(K,ID),K=1,NPH)
   88 CONTINUE                                                          
   69 CONTINUE                                                          
   71 FORMAT(5(1X,E12.5))                                            
   72 FORMAT(6(1X,E12.5))                                            
   73 FORMAT(7(1X,E12.5))                                            
   74 FORMAT(8(1X,E12.5))                                            
   75 FORMAT(9(1X,E12.5))                                            
   76 FORMAT(10(1X,E12.5))                                            
   77 FORMAT(11(1X,E12.5))                                            
   78 FORMAT(12(1X,E12.5))                                            
      RETURN
      END