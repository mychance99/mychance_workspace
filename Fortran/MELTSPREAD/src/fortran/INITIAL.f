C...................................................................... 
C.....GIVEN THE INPUT DATA, SUBROUTINE INITIAL INITIALIZES THE
C.....CALCULATION; I.E. SETS THE BASEMAT NODAL DIMENSIONS, THERMAL
C.....CONDITIONS, ENTHALPIES, AND TEMPERATURES, SET UP THE SPREADING    
C.....NODAL DIMENSIONS, SET UP NODAL DIMENSIONS FOR THE SHELL HEATUP      
C.....CALC IF THE SHELL CALCULATION IS TO BE PERFORMED, AND PRINTS 
C.....INTIAL DATA.   
C...................................................................... 
      SUBROUTINE INITIAL
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      REAL(8) KL
      COMMON /WATVARS/FCRUST(999),VLW(999),VLWOLD(999),DWAT(999),
     1DWATOLD(999),EWAT(999),EWATOLD(999),TWAT(999),CORDDC(999),
     2DSRDC(999),DHDC(999),TSRDC,TINTDC,HWATB(999),TSURFW(999),XMS(999),
     3XMST,XINTS,ESRDTW(999),TSRDTW(999),DSRDTW(999),TSRDW,TINTDW,
     4TWATI,ELDCO(999),ELDCX(999,99),CRDCX(999,99),TIMINJ(999,99),
     5XDTINJ(999,99),TDTINJ(999,99),ELWATI,XMWAT,XMWATO,XBALW,
     6HDRY(999),EINTW,XMCT(199),XMCDT(16,999),TMPCDT(999),CMPCDT(999),
     7FDC(999),FCOV(999),FBED(999),FHEAT(999),XFACJ(999),
     8XMBEDJ(16,999),XMBEDJT(999),PBED,QBED(999),QWATER(999),
     9QSURFACE(999),QWATERT(999),HBED(999),POROSBED,XMCRDT(16,999),
     1XMCRT(999),XMBDINT(999),XMT(999)
      COMMON/CATCHR/A(999),B(999),C(999),D(999),P(999),Q(999),
     1RECON(999),DELVEL(999),DSRDT(999),DELHTS(999),EMAX(999,999),
     2DBLKEN(999),DELHIT(16,999),SOURCE(16,999),SRCTOT(999),
     3HCROLD(16,999),DCDOT(999),HCRUST(16,999),DFILM(16,999),
     4DFMOLD(16,999),DENOLD(999),SIGOX(999),SIGCON(999),BET(999),
     5TFZX(999),TFZC(999),TKX(999),TKM(999),THETO(999,999),
     6THET1(999,999),OMEG0(4,999),OMEG1(4,999),TAO0(999),TAO1(999),
     7SIG0(999),SIG1(999),TARGB(999),DADOT(999),DADOTG(999),
     8XLOLD(4,999),VISREX(999),TATMS(999),HTMP(999),DHTMP(999),
     9HTMOLD(999)
      COMMON/CATCHI/NUMS(4,999),NUMOLD(4,999),NTRACK(16),NSUMP(999),
     1NPASSG(999),NCRSTM(999),NCRRT(999),NPASS(999),NBURN,NBURNO     
      COMMON/PRINTB/ELEVAT(999),ELOLD(999),XDIST(999,999),XBTW(999,999),
     1TEMP(999,999),ENTHP(999,999),EOLD(999,999),ENBLK(999),EBKOLD(999),
     2TBULK(999),HITE(16,999),HITOLD(16,999),HTOT(999),HTOLD(999),
     3HTCFT(999),HTCOEF(999),QFLUXT(999),QFLUXB(999),VEL(999),ELO(999),
     4VELOLD(999),SRSCOR(16),AREA(999),RAD(999),ARC(999),VOLCN(16),
     5VOID(999),VGJ(999),ZABLAT(999),ZABOLD(999),DCRUST(999),
     6DCROLD(999),DABCON(999),DABOLD(999),DFILMT(999),DFOLT(999),
     7SMFLX(4,999),XLSMF(4,999),TOTVOL,XFACMS(999),XMFLXA,XMCORT,
     8VCORT,TOTOX,TOTMET,QFLXT,QFLXB,TIME,DTIME,XMCOR(16),VCOR(16),
     9TCONI,RSAND,HDOWNC,TBOUND,EMISCN,PDRYWL,XDISTO(999),QOXT(999),
     1XLENSH,XBTWO(999),RCOMP,WDOOR,RSUMP,RSHELL,RPED,TPED,ELSMP,
     1TENDP(10,999),TFRZSH,TDEBRS,TKDEBR,PDEBR,CPDEBR,ENENDP(10,999),
     2ENOLDP(10,999),DXVERT,DXSNK,XDSTE(10,999),XBTE(10,999),HXLA(999),
     3HXLB(999),TSFEB(999),DCRS(999),DCRSLD(999),HCRS(16,999),
     4HCRSLD(16,999),THETE0(10,999),THETE1(10,999),QSHELL,QSHELE,TSHELI,
     5SIGOXE(999),FKOXE(999),RINJC,XLSEC,ANGSEC,ANINJC,XLCHAN,WCHNL,
     6TEFZX(999),TIMSPC(999),DXNODE(999),TNORM(999),FRCSOL(999),
     7ALPSPR(999),CRAMCON,HINTF,TSHLMX,XFRMX(999),XFROX(999),XFRTX(999),
     8XMLMX(999),XMLOX(999),XMLTX(999),XTOTX(999),TIMEO,TMAX,EDOWN(999),
     9HCP(999)
      COMMON/HCONS/HMETAL(999),HOXIDE(999)  
      COMMON/PROPI/ NMATC,NMATFI,NMATFF,ICAOH2,ICACO3,IMCCO3,IFH2O,     
     1IVH2O,ICK2O,IVK2O,INA2O,ITIO2,ISIO2,ICAO,IMGO,IAL2O3,IFEO,IFE2O3, 
     2IFE3O4,IFE,ICR,INI,IZR,IU,IB4C,IB,ICR2O3,INIO,IUO2,IZRO2,IB2O3,   
     3NBCINT(999),NODES(999),NUMNOD,IMOX(28),IBAS,ILCS,ILL,NACTIV(999),     
     4NBFRZM,NBFRZO,NABLFM,NDRNFM,NTYPMT(999,999),NDOOR,NBMADJ,NUMSHV,   
     5NBSHL(999),NCRSTS(999),NUMSHH,NSKIPE,NACSH,NWAT,NPEND,NBCBOT,
     6NCRTOP,NBFZOE,NBFZME,NGEOM,NL(999,999),NFRSCT,NLOGSH,NADAB,NINVIS,
     7NSIMST,NSTEEL,NOVHT,NOVTK,NOVUM,NOVEM,NOVSIG,NPLLOC(999),NBPL,
     8IXP(999),IYP(999),NVTPE,NSOLTP,NSOLF,NINTF,IFLGA(999),ICTYPE,ICTC,
     9NPOURS,NSMP,NPED,NDOR,NSHL,NANULS,NSMPCV,NBOIL,NSWALL,NMVER,
     1NCRTEM,NTHINC,NVELP,NITMAX,NENMAX,NPRINT,NPFREQ,NTIMSPC,NPLFREQ,
     2NPLTOT,NJET,NJETP,NJETD,NJETND,NODCAP,NVELPW,NITMAXW,NENMXW,
     3IFLGJ(999),NBEDCQ,ISHELE
      COMMON/PRINTR/ QFEH2O,QCRH2O,QZRH2O,QFECO2,QCRCO2,QZRCO2,
     4XFH2OU,XFCAOH,XFMGCA,XFCACO,XZRMRE,XFEMRE,XCRMRE,XZRORE,XFEORE,   
     5XCRORE,XMH2O,XMCO2,XMCACO,XMMGCA,XMCAOH,TFWL,TFWS,TBWL,TBWS,      
     6TMCAL,TMCAS,TCAL,TCAS,TFOS,TFOL,TFMS,TFML,XVISC(28),SVISC(28),    
     7XMOL(28),FMMOL(28),ROM(28),ROMLIQ(28),AEQM(28,2),BEQM(28,2),
     8CEQM(28,2),ECL,ECS,ECAL,ECAS,EMCAL,EMCAS,EBWL,EBWS,EFWL,EFWS,    
     9STEF,GRAV,PI,TCS,TCL,CCL,CCS,RMASSL,WPCC,WPM,WPA,WPCS,ROC,RMASSS,   
     1ANGSHL,RSLAGL,RSLAGS,HNODT,VFAV,VGAV,QXAV,XWTSS(16),  
     2TSCS(2),TSCL(2),ESCS(2),ESCL(2),CCSS(2),CCSL(2),ROSTLS,ROSTLL,
     3XFRGAS,HMINC,TST(99),TSTOP(99),AINTP(99),BINTP(99),DRATIO(999),
     4XBCN(999),XDCN(999),XBLT(15),ADEC(99),BDEC(99),APOUR(16,99),
     5BPOUR(16,99),XWTC(14),BWIDTH,THCKCV,TMBOIL,TEBOIL,VFINT,ANGFAN,
     6ALPMAX,THSHL,XFCABL,XNDMIN,DVMX,DAVMX,DEAVMX,DEMX,TDC,QDCU,QDCUO2,
     7TSINJ,EINJ,DTINJ,TKINJ,ROEV,CPINJ,SURFT,VSINJ,EMINJ,TSINJO,EINJO,
     8DTINJO,TKINJO,ROEVO,CPINJO,SURFTO,VSINJO,EMINJO,XLEADE,ARSUM,
     9DBUBOX,UTRISE,TREMSH,DJET,DFALL,WEBER,FROUDE,XPSAITO,XPEPSTN,
     1FRAG,XMBEDT,XMBED(16),XLPENT,XLPENA,UJET,UFALL,HFALL,ERPV,
     2TJETT(99),DJETT(99),HWATP,XDOTJET,DVMXW,DAVMXW,DEMXW,DEAVMXW,
     3QJETW,XSTMJF,TINTSJF,ESAT,DRDOOR,DRANL,EI,QDCBUO2,QDCBU,
     4EBEDS,EBEDB
      COMMON/PROPB/CPBM(999),FKB(999,999),DENB(999,999),DTDEB(999,999),
     1EMIBM(999),DENCRS(999),ENCRS(999),FKRF(999),DENRF(999),CPRF(999)
      TREF=298.15D0      
      TREF1=273.15D0
      ZERO=0.D0
      TWO=2.D0
      NODCAP=999
      PI=3.141592654D0
      STEF=5.6D-08
C.....FIRST INITIALIZE BASEMAT PROPERTIES AND THERMAL CONDITIONS
      DO 39 KN=1,NUMNOD
      NODES(KN)=NMVER 
   39 CONTINUE
      CALL CPROPI
      CALL DENSC      
      CALL ETC(EI,EMI,TCONI,DTDEIC,RMASS) 
      CALL TEC(ECL,ECL,TPASS,DTDE,RMASSL,YCACO3,YMCCO3,YCAOH2,YFH2O,1)  
      CALL TEC(ECS,ECS,TPASS,DTDE,RMASSS,YCACO3,YMCCO3,YCAOH2,YFH2O,1)
      CALL TEC(ZERO,ZERO,TCONI,DTDEIS,RMS,YC1,YC2,YC3,YC4,2)
      DO 4193 KH=1,NUMNOD
      DO 5131 KV=1,NODES(KH)    
      TEMP(KV,KH)=TCONI
      ENTHP(KV,KH)=EI 
      IF(NL(KV,KH).EQ.2) ENTHP(KV,KH)=0.D0
      EMAX(KV,KH)=EMI 
      IF(NL(KV,KH).EQ.2) EMAX(KV,KH)=0.D0
      DTDEB(KV,KH)=DTDEIC
      IF(NL(KV,KH).EQ.2) DTDEB(KV,KH)=DTDEIS
      KARG=KV
      XDIST(KV,KH)=XDCN(KARG)   
      XBTW(KV,KH)=XBCN(KARG)    
 5131 CONTINUE
 4193 CONTINUE
C.....DETERMINE TOTAL DEPTH OF NODALIZED BASEMAT    
      DXSNK=0.D0      
      DO 6626 KD=1,NODES(1)-1   
      DXSNK=DXSNK+XDIST(KD,1)   
 6626 CONTINUE
C.....SET SHELL NODAL DIMENSIONS.
      IF(NSKIPE.EQ.0) GO TO 8132
      DXHR=THSHL/FLOAT(NUMSHH)  
      DXVERT=HNODT/FLOAT(NUMSHV)
      NUMSHV=NUMSHV+1 
      DO 7131 KV=1,NUMSHV
      DO 7131 KH=1,NUMSHH
      XBTE(KH,KV)=0.5D0*DXHR    
      XDSTE(KH,KV)=DXHR
 7131 CONTINUE
 8132 CONTINUE
C.....SET UP SPREADING NODALIZATION SCHEME, ELEVATIONS, AND MASS MAPPING
C.....FACTORS.
      GO TO(4618,4619),NGEOM    
 4618 CONTINUE
      DRNDS=RSUMP/FLOAT(NSMP)   
      DRPED=(RPED-RSUMP)/FLOAT(NPED)      
      DRDOOR=TPED/FLOAT(NDOR)   
      DRSHL=(RSHELL-RPED-TPED)/FLOAT(NSHL)
      RPD=RPED+TPED   
      ANALAR=PI*(ANGFAN/360.D0) 
      ROFFS=WDOOR/(TWO*TAN(ANALAR))      
      ROFFA=SQRT(ROFFS*ROFFS+WDOOR*WDOOR/4.D0)      
      ASEC=(PI*(RSHELL-RPD+ROFFS)**2)*(ANGFAN/360.D0)-ROFFS*WDOOR 
     1/TWO
      AANUL=PI*(RSHELL*RSHELL-RPD*RPD)    
      AANND=(AANUL/FLOAT(NDOOR)-ASEC)/FLOAT(NANULS) 
      WANL=TWO*(RSHELL-RPD)    
      DRANL=AANND/WANL
      RAD(1)=DRNDS/TWO
      ARC(1)=0.D0     
      AREA(1)=(PI*DRNDS*DRNDS)/FLOAT(NDOOR)
      HCP(1)=1.D06
      DXNODE(1)=DRNDS 
      DO 7711 KD=2,NUMNOD
      HCP(KD)=1.D06
      IF(KD.GT.NSMP) GO TO 7712 
      DXNODE(KD)=DRNDS
      RAD(KD)=RAD(KD-1)+DRNDS   
      RCP=RAD(KD)+DRNDS/TWO     
      RCM=RAD(KD)-DRNDS/TWO     
      AREA(KD)=(PI*(RCP*RCP-RCM*RCM))/FLOAT(NDOOR)  
      ARC(KD)=(TWO*PI*RCM)/FLOAT(NDOOR)  
      GO TO 7711      
 7712 CONTINUE
      IF(KD.GT.NSMP+NPED) GO TO 7713      
      DXNODE(KD)=DRPED
      IF(KD.EQ.NSMP+1) RAD(KD)=RAD(KD-1)+0.5D0*(DRNDS+DRPED)  
      IF(KD.GT.NSMP+1) RAD(KD)=RAD(KD-1)+DRPED      
      RCP=RAD(KD)+DRPED/TWO     
      RCM=RAD(KD)-DRPED/TWO     
      AREA(KD)=(PI*(RCP*RCP-RCM*RCM))/FLOAT(NDOOR)  
      ARC(KD)=(TWO*PI*RCM)/FLOAT(NDOOR)  
      GO TO 7711      
 7713 CONTINUE
      IF(KD.GT.NSMP+NPED+NDOR) GO TO 7714 
      DXNODE(KD)=DRDOOR
      IF(KD.EQ.NSMP+NPED+1) RAD(KD)=RAD(KD-1)+0.5D0*(DRPED+DRDOOR)      
      IF(KD.GT.NSMP+NPED+1) RAD(KD)=RAD(KD-1)+DRDOOR
      RCP=RAD(KD)+DRDOOR/TWO    
      RCM=RAD(KD)-DRDOOR/TWO    
      AREA(KD)=(RCP-RCM)*WDOOR  
      ARC(KD)=WDOOR   
      GO TO 7711      
 7714 CONTINUE
      IF(KD.GT.NSMP+NPED+NDOR+NSHL) GO TO 7715      
      DXNODE(KD)=DRSHL
      IF(KD.EQ.NSMP+NPED+NDOR+1) RAD(KD)=RAD(KD-1)+0.5D0*(DRDOOR+DRSHL) 
      IF(KD.GT.NSMP+NPED+NDOR+1) RAD(KD)=RAD(KD-1)+DRSHL      
      RCP=RAD(KD)+DRSHL/TWO-RPED-TPED+ROFFA
      RCM=RAD(KD)-DRSHL/TWO-RPED-TPED+ROFFA
      ARC(KD)=TWO*PI*RCM*(ANGFAN/360.D0) 
      IF(KD.EQ.NSMP+NPED+NDOR+1) ARC(KD)=WDOOR      
      AREA(KD)=(PI*(RCP*RCP-RCM*RCM))*(ANGFAN/360.D0)
      IF(KD.EQ.NSMP+NPED+NDOR+1) AREA(KD)=(PI*RCP*RCP)*(ANGFAN/360.D0)  
     1-ROFFS*WDOOR/TWO
      GO TO 7711      
 7715 CONTINUE
      DXNODE(KD)=DRANL
      IF(KD.EQ.NSMP+NPED+NDOR+NSHL+1) RAD(KD)=RAD(KD-1)+0.5D0*(DRSHL+DRA
     1NL)   
      IF(KD.GT.NSMP+NPED+NDOR+NSHL+1) RAD(KD)=RAD(KD-1)+DRANL 
      ARC(KD)=WANL    
      IF(KD.EQ.NSMP+NPED+NDOR+NSHL+1) ARC(KD)=WDOOR+(RSHELL-RPED-TPED)* 
     1TAN(ANALAR)     
      AREA(KD)=AANND  
 7711 CONTINUE
      ARC(NUMNOD+1)=WANL
      DO 7716 KD=1,NUMNOD
      NSUMP(KD)=0
      ELEVAT(KD)=0.D0 
      ELO(KD)=ELEVAT(KD)
      IF(KD.GT.NSMP) GO TO 7716 
      ELEVAT(KD)=-ABS(ELSMP)    
      ELO(KD)=ELEVAT(KD)
 7716 CONTINUE
      IF(ELSMP.NE.0.D0) NSUMP(NSMP+1)=1
      AFLOW=PI*RCOMP*RCOMP      
      IF(AFLOW.GT.AREA(1)) GO TO 3200
      XFACMS(1)=1.D0/AREA(1)
      DO 3300 KN=2,NUMNOD
      XFACMS(KN)=0.D0
 3300 CONTINUE
      GO TO 4619
 3200 CONTINUE 
      ASUM=0.D0
      NPX=0 
      DO 6004 KN=1,NUMNOD
      XFACMS(KN)=0.D0
      IF(NPX.EQ.1) GO TO 6004 
      ASUM=ASUM+AREA(KN)
      XFACMS(KN)=1.D0/AFLOW
      IF(ASUM.LE.AFLOW) GO TO 6004
      NPX=1
      ASUMM1=ASUM-AREA(KN)
      XFACMS(KN)=(1.D0-ASUMM1/AFLOW)/AREA(KN)
      XFACMS(KN)=DMAX1(XFACMS(KN),0.D0)
 6004 CONTINUE
 4619 CONTINUE
C.....WITH MESH KNOWN, DETERMINE JET BREAKUP MAPPING FACTORS IF THE
C.....JET MODEL IS ACTIVATE AND THE BED FORMATION MODEL IS ON.
      IF(NJET.LE.1) GO TO 911
      XMAP=0.D0
      DO 913 K=1,NUMNOD
      IF(IFLGJ(K).EQ.1) XMAP=XMAP+AREA(K)
  913 CONTINUE
      DO 914 K=1,NUMNOD
      XFACJ(K)=0.D0
      IF(IFLGJ(K).EQ.1) XFACJ(K)=AREA(K)/XMAP
  914 CONTINUE
  911 CONTINUE
C.....SET CONDUCTION LIMIT LENGTH SCALE FOR SHELL HEATUP MODEL.
      IF(NGEOM.EQ.1) XLENSH=0.5D0*DRSHL   
      IF(NGEOM.EQ.2) XLENSH=0.5D0*DXNODE(NUMNOD)    
C.....INITIALIZE REMAINING VECTORS AND SET INITIAL VALUES.    
      IF(NWAT.EQ.2) CALL TWENTH(EWATI,TWATI,PDRYWL,DTDE)
      IF(NWAT.EQ.0) GO TO 811 
      CALL CONWAT(TSAT,KL,PL,CL,UL,HLV,EWL,EWV,CWV,SIGMA,PDRYWL)
  811 CONTINUE
      XMWATO=0.D0
      XBALW=0.D0
      DO 8913 KH=1,NUMNOD
      DADOT(KH)=0.D0  
      DADOTG(KH)=0.D0 
      DCDOT(KH)=0.D0  
      TBULK(KH)=298.15
      ENBLK(KH)=0.0   
      HTMP(KH)=0.D0   
      DHTMP(KH)=0.D0  
      HTMOLD(KH)=0.D0 
      HTOT(KH)=0.D0   
      HMETAL(KH)=0.D0 
      HOXIDE(KH)=0.D0 
      VEL(KH)=0.D0    
      VOID(KH)=0.D0   
      VGJ(KH)=0.D0    
      HTCFT(KH)=0.D0  
      HTCOEF(KH)=0.D0 
      QFLUXT(KH)=0.D0 
      QFLUXB(KH)=0.D0 
      XDISTO(KH)=XDIST(1,KH)    
      XBTWO(KH)=XBTW(1,KH)      
      ZABLAT(KH)=XDISTO(KH)     
      DCRUST(KH)=0.D0 
      DABCON(KH)=0.D0 
      DFILMT(KH)=0.D0 
      NBCINT(KH)=1    
      NCRRT(KH)=1     
      NACTIV(KH)=0    
      NPASS(KH)=0     
      FHEAT(KH)=1.D0
      FCRUST(KH)=1.D0
      FBED(KH)=1.D0
      FCOV(KH)=0.D0
      FDC(KH)=1.D0
      IF(NWAT.GT.0) GO TO 77
      DWAT(KH)=0.D0
      GO TO 78
   77 CONTINUE
      IF(NWAT.EQ.2) GO TO 81
      DWAT(KH)=HDOWNC-ELEVAT(KH)
      DWAT(KH)=DMAX1(DWAT(KH),0.D0)
      XMWATO=XMWATO+PL*DWAT(KH)*AREA(KH)
      GO TO 78
   81 CONTINUE
      DWAT(KH)=ELWATI-ELEVAT(KH)
      XMWATO=XMWATO+PL*DWAT(KH)*AREA(KH)
      DWATOLD(KH)=DWAT(KH)
      EWAT(KH)=EWATI
      EWATOLD(KH)=EWATI
      TWAT(KH)=TWATI
      VLW(KH)=0.D0
      VLWOLD(KH)=0.D0
      HWATB(KH)=0.D0
      HDRY(KH)=0.D0
      TSURFW(KH)=TCONI
      CORDDC(KH)=0.D0
      DSRDC(KH)=0.D0
      DHDC(KH)=0.D0
      DSRDTW(KH)=0.D0
      XMS(KH)=0.D0
      ESRDTW(KH)=0.D0
      TSRDTW(KH)=TREF1
      XMS(KH)=0.D0
      QBED(KH)=0.D0
      QSURFACE(KH)=0.D0
      QWATER(KH)=0.D0
      QWATERT(KH)=0.D0
      XMBEDJT(KH)=0.D0
      XMBDINT(KH)=0.D0
   78 CONTINUE
      XMWAT=XMWATO
      DO 8465 KG=1,4  
      SMFLX(KG,KH)=0.D0
      XLSMF(KG,KH)=0.D0
      NUMS(KG,KH)=1   
      DO 8466 KV=1,NODES(KH)    
      THETO(KV,KH)=0.D0
      THET1(KV,KH)=0.D0
 8466 CONTINUE
 8465 CONTINUE
 8913 CONTINUE
      DO 7195 KH=1,NUMNOD
      DO 3007 KT=1,16 
      HITE(KT,KH)=0.D0
      HCRUST(KT,KH)=0.D0
      DFILM(KT,KH)=0.D0
      XMBEDJ(KT,KH)=0.D0
 3007 CONTINUE
 7195 CONTINUE
      DO 992 KT=1,16  
      SRSCOR(KT)=0.D0 
      NTRACK(KT)=0    
      XMCOR(KT)=0.D0  
      XMBED(KT)=0.D0
  992 CONTINUE
      TOTVOL=0.D0     
      TOTMET=0.D0     
      TOTOX=0.D0      
      QFLXT=0.D0      
      QFLXB=0.D0      
      XMCORT=0.D0     
      XMBEDT=0.D0
      VCORT=0.D0      
      VFAV=0.D0
      VGAV=0.D0
      QXAV=0.D0
      ARSUM=0.D0
      NACSH=0
      QSHELL=0.D0     
      QSHELE=0.D0     
      NFRSCT=0
      TSRDC=0.D0
      TINTDC=0.D0
      XMST=0.D0
      XINTS=0.D0
      TSRDW=0.D0
      TINTDW=0.D0
      EINTW=0.D0
      QJETW=0.D0
      XSTMJF=0.D0
      TSHLMX=DMAX1(TSHELI,TREF)
      ISHELE=0
      IF(NSKIPE.EQ.0) GO TO 1091
      CALL ETSS(ESI,TSHELI,DTDE)
      DO 996 KV=1,NUMSHV
      NBSHL(KV)=1     
      NCRSTS(KV)=0    
      HXLA(KV)=0.D0   
      HXLB(KV)=0.D0   
      DCRS(KV)=0.D0   
      DCRSLD(KV)=0.D0 
      TSFEB(KV)=0.D0  
      DO 997 KH=1,NUMSHH
      TENDP(KH,KV)=TSHELI
      ENENDP(KH,KV)=ESI
      THETE0(KH,KV)=0.D0
      THETE1(KH,KV)=0.D0
  997 CONTINUE
      DO 998 KT=1,16  
      HCRS(KT,KV)=0.D0
      HCRSLD(KT,KV)=0.D0
  998 CONTINUE
  996 CONTINUE
 1091 CONTINUE
C.....INITIALIZE SUMP COVER PLATE CALCULATION.      
      IF(NSMPCV.EQ.0) GO TO 1088
      NBURNO=0
      NBURN=0
      DO 1089 K=1,NSMP
      XDISTO(K)=XDIST(1,K)-XBTW(1,K)+THCKCV
      XBTWO(K)=THCKCV 
      XDIST(1,K)=XDISTO(K)      
      XBTW(1,K)=XBTWO(K)
      ZABLAT(K)=XDISTO(K)
      ZABOLD(K)=ZABLAT(K)
      ELEVAT(K)=0.D0  
      ELOLD(K)=0.D0   
      NTYPMT(1,K)=ICTYPE
      TEMP(1,K)=TCONI 
      ENTHP(1,K)=0.D0 
      EOLD(1,K)=0.D0  
      NL(1,K)=2
      NPASSG(K)=1     
 1089 CONTINUE
      NSUMP(NSMP+1)=0 
 1088 CONTINUE
      DO 1817 KH=1,NUMNOD
      NPASSG(KH)=0    
      IF(NL(1,KH).EQ.1) GO TO 1817
      IF(NL(1,KH).EQ.0) GO TO 1817
      NPASSG(KH)=1    
 1817 CONTINUE
C.....WRITE INITIAL DATA.
      CALL PRINTS(0)
      RETURN
      END