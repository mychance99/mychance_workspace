C...................................................................... 
C.....SUBROUTINE PLOTCQ SAVES END-OF-RUN DEBRIS DISTRIBUTION, 
C.....TEMPERATURE, AND GEOMETRY DATA IN A FORMAT THAT IS EASY TO 
C.....INVENTORY MODEL IS BEING USED IN THE CALCULATION.
C...................................................................... 
      SUBROUTINE CQSTART
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DIMENSION HASIGN(28),BASIGN(28),CASIGN(28)
      COMMON /WATVARS/FCRUST(999),VLW(999),VLWOLD(999),DWAT(999),
     1DWATOLD(999),EWAT(999),EWATOLD(999),TWAT(999),CORDDC(999),
     2DSRDC(999),DHDC(999),TSRDC,TINTDC,HWATB(999),TSURFW(999),XMS(999),
     3XMST,XINTS,ESRDTW(999),TSRDTW(999),DSRDTW(999),TSRDW,TINTDW,
     4TWATI,ELDCO(999),ELDCX(999,99),CRDCX(999,99),TIMINJ(999,99),
     5XDTINJ(999,99),TDTINJ(999,99),ELWATI,XMWAT,XMWATO,XBALW,
     6HDRY(999),EINTW,XMCT(199),XMCDT(16,999),TMPCDT(999),CMPCDT(999),
     7FDC(999),FCOV(999),FBED(999),FHEAT(999),XFACJ(999),
     8XMBEDJ(16,999),XMBEDJT(999),PBED,QBED(999),QWATER(999),
     9QSURFACE(999),QWATERT(999),HBED(999),POROSBED,XMCRDT(16,999),
     1XMCRT(999),XMBDINT(999),XMT(999)
      COMMON/PRINTB/ELEVAT(999),ELOLD(999),XDIST(999,999),XBTW(999,999),
     1TEMP(999,999),ENTHP(999,999),EOLD(999,999),ENBLK(999),EBKOLD(999),
     2TBULK(999),HITE(16,999),HITOLD(16,999),HTOT(999),HTOLD(999),
     3HTCFT(999),HTCOEF(999),QFLUXT(999),QFLUXB(999),VEL(999),ELO(999),
     4VELOLD(999),SRSCOR(16),AREA(999),RAD(999),ARC(999),VOLCN(16),
     5VOID(999),VGJ(999),ZABLAT(999),ZABOLD(999),DCRUST(999),
     6DCROLD(999),DABCON(999),DABOLD(999),DFILMT(999),DFOLT(999),
     7SMFLX(4,999),XLSMF(4,999),TOTVOL,XFACMS(999),XMFLXA,XMCORT,
     8VCORT,TOTOX,TOTMET,QFLXT,QFLXB,TIME,DTIME,XMCOR(16),VCOR(16),
     9TCONI,RSAND,HDOWNC,TBOUND,EMISCN,PDRYWL,XDISTO(999),QOXT(999),
     1XLENSH,XBTWO(999),RCOMP,WDOOR,RSUMP,RSHELL,RPED,TPED,ELSMP,
     1TENDP(10,999),TFRZSH,TDEBRS,TKDEBR,PDEBR,CPDEBR,ENENDP(10,999),
     2ENOLDP(10,999),DXVERT,DXSNK,XDSTE(10,999),XBTE(10,999),HXLA(999),
     3HXLB(999),TSFEB(999),DCRS(999),DCRSLD(999),HCRS(16,999),
     4HCRSLD(16,999),THETE0(10,999),THETE1(10,999),QSHELL,QSHELE,TSHELI,
     5SIGOXE(999),FKOXE(999),RINJC,XLSEC,ANGSEC,ANINJC,XLCHAN,WCHNL,
     6TEFZX(999),TIMSPC(999),DXNODE(999),TNORM(999),FRCSOL(999),
     7ALPSPR(999),CRAMCON,HINTF,TSHLMX,XFRMX(999),XFROX(999),XFRTX(999),
     8XMLMX(999),XMLOX(999),XMLTX(999),XTOTX(999),TIMEO,TMAX,EDOWN(999),
     9HCP(999)
      COMMON/PROPI/ NMATC,NMATFI,NMATFF,ICAOH2,ICACO3,IMCCO3,IFH2O,     
     1IVH2O,ICK2O,IVK2O,INA2O,ITIO2,ISIO2,ICAO,IMGO,IAL2O3,IFEO,IFE2O3, 
     2IFE3O4,IFE,ICR,INI,IZR,IU,IB4C,IB,ICR2O3,INIO,IUO2,IZRO2,IB2O3,   
     3NBCINT(999),NODES(999),NUMNOD,IMOX(28),IBAS,ILCS,ILL,NACTIV(999),     
     4NBFRZM,NBFRZO,NABLFM,NDRNFM,NTYPMT(999,999),NDOOR,NBMADJ,NUMSHV,   
     5NBSHL(999),NCRSTS(999),NUMSHH,NSKIPE,NACSH,NWAT,NPEND,NBCBOT,
     6NCRTOP,NBFZOE,NBFZME,NGEOM,NL(999,999),NFRSCT,NLOGSH,NADAB,NINVIS,
     7NSIMST,NSTEEL,NOVHT,NOVTK,NOVUM,NOVEM,NOVSIG,NPLLOC(999),NBPL,
     8IXP(999),IYP(999),NVTPE,NSOLTP,NSOLF,NINTF,IFLGA(999),ICTYPE,ICTC,
     9NPOURS,NSMP,NPED,NDOR,NSHL,NANULS,NSMPCV,NBOIL,NSWALL,NMVER,
     1NCRTEM,NTHINC,NVELP,NITMAX,NENMAX,NPRINT,NPFREQ,NTIMSPC,NPLFREQ,
     2NPLTOT,NJET,NJETP,NJETD,NJETND,NODCAP,NVELPW,NITMAXW,NENMXW,
     3IFLGJ(999),NBEDCQ,ISHELE
      COMMON/PRINTR/ QFEH2O,QCRH2O,QZRH2O,QFECO2,QCRCO2,QZRCO2,
     4XFH2OU,XFCAOH,XFMGCA,XFCACO,XZRMRE,XFEMRE,XCRMRE,XZRORE,XFEORE,   
     5XCRORE,XMH2O,XMCO2,XMCACO,XMMGCA,XMCAOH,TFWL,TFWS,TBWL,TBWS,      
     6TMCAL,TMCAS,TCAL,TCAS,TFOS,TFOL,TFMS,TFML,XVISC(28),SVISC(28),    
     7XMOL(28),FMMOL(28),ROM(28),ROMLIQ(28),AEQM(28,2),BEQM(28,2),
     8CEQM(28,2),ECL,ECS,ECAL,ECAS,EMCAL,EMCAS,EBWL,EBWS,EFWL,EFWS,    
     9STEF,GRAV,PI,TCS,TCL,CCL,CCS,RMASSL,WPCC,WPM,WPA,WPCS,ROC,RMASSS,   
     1ANGSHL,RSLAGL,RSLAGS,HNODT,VFAV,VGAV,QXAV,XWTSS(16),  
     2TSCS(2),TSCL(2),ESCS(2),ESCL(2),CCSS(2),CCSL(2),ROSTLS,ROSTLL,
     3XFRGAS,HMINC,TST(99),TSTOP(99),AINTP(99),BINTP(99),DRATIO(999),
     4XBCN(999),XDCN(999),XBLT(15),ADEC(99),BDEC(99),APOUR(16,99),
     5BPOUR(16,99),XWTC(14),BWIDTH,THCKCV,TMBOIL,TEBOIL,VFINT,ANGFAN,
     6ALPMAX,THSHL,XFCABL,XNDMIN,DVMX,DAVMX,DEAVMX,DEMX,TDC,QDCU,QDCUO2,
     7TSINJ,EINJ,DTINJ,TKINJ,ROEV,CPINJ,SURFT,VSINJ,EMINJ,TSINJO,EINJO,
     8DTINJO,TKINJO,ROEVO,CPINJO,SURFTO,VSINJO,EMINJO,XLEADE,ARSUM,
     9DBUBOX,UTRISE,TREMSH,DJET,DFALL,WEBER,FROUDE,XPSAITO,XPEPSTN,
     1FRAG,XMBEDT,XMBED(16),XLPENT,XLPENA,UJET,UFALL,HFALL,ERPV,
     2TJETT(99),DJETT(99),HWATP,XDOTJET,DVMXW,DAVMXW,DEMXW,DEAVMXW,
     3QJETW,XSTMJF,TINTSJF,ESAT,DRDOOR,DRANL,EI,QDCBUO2,QDCBU,
     4EBEDS,EBEDB
      DATA NCQMAT / 22 /
      DATA ZERO / 0.D0 /
C.....DATA ARE WRITTEN TO THE FILE CALLED 'cqinput'
      OPEN(UNIT=8,FILE='cqinput.dat')
C.....FORMATS FOR OUTPUTS.
    1 FORMAT(2(1X,I4),5(1X,E10.4))
    2 FORMAT(1X,I4,1X,E10.4)
    3 FORMAT(3(1X,E10.4))
      WRITE(8,2) NUMNOD,TIME
      DO 10 K=1,NUMNOD
      ELP=ELO(K)-DABCON(K)
      WRITE(8,1) K,NACTIV(K),RAD(K),ARC(K),AREA(K),DXNODE(K),ELP
      IF(NACTIV(K).EQ.0) GO TO 10
      WRITE(8,3) TMPCDT(K),CMPCDT(K),XMT(K)
C.. ..NOW WE HAVE TO REASSIGN MELT ZONE MASSES FROM MS TO CQ FACTORING
C.. ..IN THE DIFFERENCES IN FORMATING ET Al. THIS IS CURRENTLY DONE BY 
C.. ..BRUTE FORCE..... 
C.. ..THIS IS NA2O..
      HASIGN(1)=ZERO 
      CASIGN(1)=ZERO 
      BASIGN(1)=ZERO 
C... .THIS IS TIO2..
      HASIGN(2)=ZERO 
      CASIGN(2)=ZERO 
      BASIGN(2)=ZERO 
C.....THIS IS SIO2..
      HASIGN(3)=WPCS*XMCDT(16,K)
      CASIGN(3)=WPCS*XMCRDT(16,K)
      BASIGN(3)=WPCS*XMBEDJ(16,K)
C.....THIS IS CAO..
      HASIGN(4)=WPCC*XMCDT(16,K)
      CASIGN(4)=WPCC*XMCRDT(16,K)
      BASIGN(4)=WPCC*XMBEDJ(16,K)
C.....THIS IS MGO..
      HASIGN(5)=WPM*XMCDT(16,K)
      CASIGN(5)=WPM*XMCRDT(16,K)
      BASIGN(5)=WPM*XMBEDJ(16,K)
C.....THIS IS AL2O3..
      HASIGN(6)=WPA*XMCDT(16,K)
      CASIGN(6)=WPA*XMCRDT(16,K)
      BASIGN(6)=WPA*XMBEDJ(16,K)
C.....THIS IS FEO..
      HASIGN(7)=XMCDT(9,K)
      CASIGN(7)=XMCRDT(9,K)
      BASIGN(7)=XMBEDJ(9,K)
C.....THIS IS FE2O3..
      HASIGN(8)=XMCDT(10,K)
      CASIGN(8)=XMCRDT(10,K)
      BASIGN(8)=XMBEDJ(10,K)
C.....THIS IS FE3O4..
      HASIGN(9)=XMCDT(11,K)
      CASIGN(9)=XMCRDT(11,K)
      BASIGN(9)=XMBEDJ(11,K)
C.....THIS IS FE..
      HASIGN(10)=XMCDT(2,K)
      CASIGN(10)=XMCRDT(2,K)
      BASIGN(10)=XMBEDJ(2,K)
C.....THIS IS CR..
      HASIGN(11)=XMCDT(3,K)
      CASIGN(11)=XMCRDT(3,K)
      BASIGN(11)=XMBEDJ(3,K)
C.....THIS IS NI..
      HASIGN(12)=XMCDT(4,K)
      CASIGN(11)=XMCRDT(4,K)
      BASIGN(12)=XMBEDJ(4,K)
C.....THIS IS ZR..
      HASIGN(13)=XMCDT(1,K)
      CASIGN(13)=XMCRDT(1,K)
      BASIGN(13)=XMBEDJ(1,K)
C.....THIS IS ZRO2..
      HASIGN(14)=XMCDT(8,K)
      CASIGN(14)=XMCRDT(8,K)
      BASIGN(14)=XMBEDJ(8,K)
C.....THIS IS B2O3..
      HASIGN(15)=XMCDT(14,K)
      CASIGN(15)=XMCRDT(14,K)
      BASIGN(15)=XMBEDJ(14,K)
C.....THIS IS U..
      HASIGN(16)=XMCDT(6,K)
      CASIGN(16)=XMCRDT(6,K)
      BASIGN(16)=XMBEDJ(6,K)
C.....THIS IS B4C..
      HASIGN(17)=XMCDT(7,K)
      CASIGN(17)=XMCRDT(7,K)
      BASIGN(17)=XMBEDJ(7,K)
C.....THIS IS SI..
      HASIGN(18)=ZERO 
      CASIGN(18)=ZERO 
      BASIGN(18)=ZERO 
C.....THIS IS SIC..
      HASIGN(19)=ZERO 
      CASIGN(19)=ZERO 
      BASIGN(19)=ZERO 
C.....THIS IS CR2O3..
      HASIGN(20)=XMCDT(12,K)
      CASIGN(20)=XMCRDT(12,K)
      BASIGN(20)=XMBEDJ(12,K)
C.....THIS IS NIO..
      HASIGN(21)=XMCDT(13,K)
      CASIGN(21)=XMCRDT(13,K)
      BASIGN(21)=XMBEDJ(13,K)
C.....THIS IS UO2..
      HASIGN(22)=XMCDT(15,K)
      CASIGN(22)=XMCRDT(15,K)
      BASIGN(22)=XMBEDJ(15,K)
C.....NOW WRITE OUT THE DATA.
      DO 20 KTP=1,NCQMAT
      WRITE(8,3) HASIGN(KTP),CASIGN(KTP),BASIGN(KTP)
   20 CONTINUE
   10 CONTINUE
      RETURN
      END