C...................................................................... 
C.....FOR CONTAINMENTS IN WHICH SUMPS ARE PRESENT, THIS SUBROUTINE 
C.....CHECKS TO SEE IF THE COVER PLATE HAS BEEN ABLATED THROUGH.  IF   
C.....SO, IT RELOCATES THE MELT OVER THE TOP OF THE COVER PLATE TO THE   
C.....BOTTOM OF THE SUMP, AND RESETS THE SUMP BASEMAT NODES TO VIRGIN   
C.....CONCRETE.   
C......................................................................
      SUBROUTINE SUMPCVA 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DIMENSION HSEND(28)
      COMMON/CATCHR/A(999),B(999),C(999),D(999),P(999),Q(999),
     1RECON(999),DELVEL(999),DSRDT(999),DELHTS(999),EMAX(999,999),
     2DBLKEN(999),DELHIT(16,999),SOURCE(16,999),SRCTOT(999),
     3HCROLD(16,999),DCDOT(999),HCRUST(16,999),DFILM(16,999),
     4DFMOLD(16,999),DENOLD(999),SIGOX(999),SIGCON(999),BET(999),
     5TFZX(999),TFZC(999),TKX(999),TKM(999),THETO(999,999),
     6THET1(999,999),OMEG0(4,999),OMEG1(4,999),TAO0(999),TAO1(999),
     7SIG0(999),SIG1(999),TARGB(999),DADOT(999),DADOTG(999),
     8XLOLD(4,999),VISREX(999),TATMS(999),HTMP(999),DHTMP(999),
     9HTMOLD(999)
      COMMON/CATCHI/NUMS(4,999),NUMOLD(4,999),NTRACK(16),NSUMP(999),
     1NPASSG(999),NCRSTM(999),NCRRT(999),NPASS(999),NBURN,NBURNO     
      COMMON/PRINTB/ELEVAT(999),ELOLD(999),XDIST(999,999),XBTW(999,999),
     1TEMP(999,999),ENTHP(999,999),EOLD(999,999),ENBLK(999),EBKOLD(999),
     2TBULK(999),HITE(16,999),HITOLD(16,999),HTOT(999),HTOLD(999),
     3HTCFT(999),HTCOEF(999),QFLUXT(999),QFLUXB(999),VEL(999),ELO(999),
     4VELOLD(999),SRSCOR(16),AREA(999),RAD(999),ARC(999),VOLCN(16),
     5VOID(999),VGJ(999),ZABLAT(999),ZABOLD(999),DCRUST(999),
     6DCROLD(999),DABCON(999),DABOLD(999),DFILMT(999),DFOLT(999),
     7SMFLX(4,999),XLSMF(4,999),TOTVOL,XFACMS(999),XMFLXA,XMCORT,
     8VCORT,TOTOX,TOTMET,QFLXT,QFLXB,TIME,DTIME,XMCOR(16),VCOR(16),
     9TCONI,RSAND,HDOWNC,TBOUND,EMISCN,PDRYWL,XDISTO(999),QOXT(999),
     1XLENSH,XBTWO(999),RCOMP,WDOOR,RSUMP,RSHELL,RPED,TPED,ELSMP,
     1TENDP(10,999),TFRZSH,TDEBRS,TKDEBR,PDEBR,CPDEBR,ENENDP(10,999),
     2ENOLDP(10,999),DXVERT,DXSNK,XDSTE(10,999),XBTE(10,999),HXLA(999),
     3HXLB(999),TSFEB(999),DCRS(999),DCRSLD(999),HCRS(16,999),
     4HCRSLD(16,999),THETE0(10,999),THETE1(10,999),QSHELL,QSHELE,TSHELI,
     5SIGOXE(999),FKOXE(999),RINJC,XLSEC,ANGSEC,ANINJC,XLCHAN,WCHNL,
     6TEFZX(999),TIMSPC(999),DXNODE(999),TNORM(999),FRCSOL(999),
     7ALPSPR(999),CRAMCON,HINTF,TSHLMX,XFRMX(999),XFROX(999),XFRTX(999),
     8XMLMX(999),XMLOX(999),XMLTX(999),XTOTX(999),TIMEO,TMAX,EDOWN(999),
     9HCP(999)
      COMMON/PROPI/ NMATC,NMATFI,NMATFF,ICAOH2,ICACO3,IMCCO3,IFH2O,     
     1IVH2O,ICK2O,IVK2O,INA2O,ITIO2,ISIO2,ICAO,IMGO,IAL2O3,IFEO,IFE2O3, 
     2IFE3O4,IFE,ICR,INI,IZR,IU,IB4C,IB,ICR2O3,INIO,IUO2,IZRO2,IB2O3,   
     3NBCINT(999),NODES(999),NUMNOD,IMOX(28),IBAS,ILCS,ILL,NACTIV(999),     
     4NBFRZM,NBFRZO,NABLFM,NDRNFM,NTYPMT(999,999),NDOOR,NBMADJ,NUMSHV,   
     5NBSHL(999),NCRSTS(999),NUMSHH,NSKIPE,NACSH,NWAT,NPEND,NBCBOT,
     6NCRTOP,NBFZOE,NBFZME,NGEOM,NL(999,999),NFRSCT,NLOGSH,NADAB,NINVIS,
     7NSIMST,NSTEEL,NOVHT,NOVTK,NOVUM,NOVEM,NOVSIG,NPLLOC(999),NBPL,
     8IXP(999),IYP(999),NVTPE,NSOLTP,NSOLF,NINTF,IFLGA(999),ICTYPE,ICTC,
     9NPOURS,NSMP,NPED,NDOR,NSHL,NANULS,NSMPCV,NBOIL,NSWALL,NMVER,
     1NCRTEM,NTHINC,NVELP,NITMAX,NENMAX,NPRINT,NPFREQ,NTIMSPC,NPLFREQ,
     2NPLTOT,NJET,NJETP,NJETD,NJETND,NODCAP,NVELPW,NITMAXW,NENMXW,
     3IFLGJ(999),NBEDCQ,ISHELE
      COMMON/PRINTR/ QFEH2O,QCRH2O,QZRH2O,QFECO2,QCRCO2,QZRCO2,
     4XFH2OU,XFCAOH,XFMGCA,XFCACO,XZRMRE,XFEMRE,XCRMRE,XZRORE,XFEORE,   
     5XCRORE,XMH2O,XMCO2,XMCACO,XMMGCA,XMCAOH,TFWL,TFWS,TBWL,TBWS,      
     6TMCAL,TMCAS,TCAL,TCAS,TFOS,TFOL,TFMS,TFML,XVISC(28),SVISC(28),    
     7XMOL(28),FMMOL(28),ROM(28),ROMLIQ(28),AEQM(28,2),BEQM(28,2),
     8CEQM(28,2),ECL,ECS,ECAL,ECAS,EMCAL,EMCAS,EBWL,EBWS,EFWL,EFWS,    
     9STEF,GRAV,PI,TCS,TCL,CCL,CCS,RMASSL,WPCC,WPM,WPA,WPCS,ROC,RMASSS,   
     1ANGSHL,RSLAGL,RSLAGS,HNODT,VFAV,VGAV,QXAV,XWTSS(16),  
     2TSCS(2),TSCL(2),ESCS(2),ESCL(2),CCSS(2),CCSL(2),ROSTLS,ROSTLL,
     3XFRGAS,HMINC,TST(99),TSTOP(99),AINTP(99),BINTP(99),DRATIO(999),
     4XBCN(999),XDCN(999),XBLT(15),ADEC(99),BDEC(99),APOUR(16,99),
     5BPOUR(16,99),XWTC(14),BWIDTH,THCKCV,TMBOIL,TEBOIL,VFINT,ANGFAN,
     6ALPMAX,THSHL,XFCABL,XNDMIN,DVMX,DAVMX,DEAVMX,DEMX,TDC,QDCU,QDCUO2,
     7TSINJ,EINJ,DTINJ,TKINJ,ROEV,CPINJ,SURFT,VSINJ,EMINJ,TSINJO,EINJO,
     8DTINJO,TKINJO,ROEVO,CPINJO,SURFTO,VSINJO,EMINJO,XLEADE,ARSUM,
     9DBUBOX,UTRISE,TREMSH,DJET,DFALL,WEBER,FROUDE,XPSAITO,XPEPSTN,
     1FRAG,XMBEDT,XMBED(16),XLPENT,XLPENA,UJET,UFALL,HFALL,ERPV,
     2TJETT(99),DJETT(99),HWATP,XDOTJET,DVMXW,DAVMXW,DEMXW,DEAVMXW,
     3QJETW,XSTMJF,TINTSJF,ESAT,DRDOOR,DRANL,EI,QDCBUO2,QDCBU,
     4EBEDS,EBEDB
      COMMON/BASPR/ HBMT(999,999,16),HBMOLD(999,999,16) 
C.....FIRST CHECK TO SEE IF THIS ROUTINE IS APPLICABLE GIVEN THE INPUT
C.....ASSUMPTIONS    
      IF(NSMPCV.EQ.0) GO TO 1789
      IF(NBOIL.EQ.1) GO TO 4544 
      IF(NBURN.EQ.1) GO TO 1789 
      IF(NBCINT(1).LE.3) GO TO 1789
      DBURN=ABS(ELEVAT(1))      
      IF(DBURN.LT.THCKCV) GO TO 1789      
      IF(ELEVAT(1).GT.0.D0) GO TO 1789    
C.....ALGORITHM REACHES HERE, THE SUMP COVER PLATE HAS BEEN ABLATED     
C.....THROUGH.
      WRITE(6,913) TIME
 913  FORMAT(//,1X,'****SUMP COVER PLATE HAS BEEN ABLATED THROUGH****',/
     1/,5X,'TIME=',G12.5,//)    
      NBURN=1
      DO 4549 K=1,NSMP
      IF(K.EQ.1) GO TO 5561     
      IF(ELEVAT(K).LT.0.D0) ELEVAT(K)=THCKCV+ELEVAT(K)-ABS(ELSMP)
      IF(ELEVAT(K).GE.0.D0) ELEVAT(K)=ELEVAT(K)-ABS(ELSMP)    
      ELOLD(K)=ELEVAT(K)
      VEL(K+1)=0.D0   
      DO 5562 KGS=1,4 
      XLSMF(KGS,K)=0.D0
      NUMS(KGS,K)=1   
 5562 CONTINUE
      DO 5563 KV=1,NODES(K)     
      IF(NTYPMT(KV,K).GT.3) GO TO 5563    
      IF(NL(KV,K).EQ.2) GO TO 5563
      TEMP(KV,K)=TCONI
      ENTHP(KV,K)=EI  
      EMAX(KV,K)=EI   
      EOLD(KV,K)=EI   
 5563 CONTINUE
      GO TO 4549      
 5561 CONTINUE
      XDISTO(K)=XDCN(1)
      XBTWO(K)=XBCN(1)
      XDIST(1,K)=XDISTO(K)      
      XBTW(1,K)=XBTWO(K)
      ZABLAT(K)=XDISTO(K)
      ZABOLD(K)=ZABLAT(K)
      ELEVAT(K)=-ABS(ELSMP)     
      ELOLD(K)=ELEVAT(K)
      NPASSG(K)=0     
      NBCINT(K)=1     
      VEL(K+1)=0.D00  
      NODES(K)=NMVER  
      DO 8811 KGS=1,4 
      XLSMF(KGS,K)=0.D0
      NUMS(KGS,K)=1   
 8811 CONTINUE
      DO 6199 KV=1,NODES(K)     
      NTYPMT(KV,K)=ICTYPE
      TEMP(KV,K)=TCONI
      IF(NL(KV,K).EQ.2) GO TO 7333
      ENTHP(KV,K)=EI  
      EMAX(KV,K)=EI   
      EOLD(KV,K)=EI   
      GO TO 6199
 7333 CONTINUE
      ENTHP(KV,K)=0.D0
      EMAX(KV,K)=0.D0
      EOLD(KV,K)=0.D0   
 6199 CONTINUE
 4549 CONTINUE
      IF(ELSMP.NE.0.D0) NSUMP(NSMP+1)=1   
      GO TO 1789      
 4544 CONTINUE
      IF(NBURNO.EQ.1) GO TO 1789
      IF(TIME.LT.TMBOIL) GO TO 1789
      NBURNO=1
      NBURN=1
      WRITE(6,4545) TIME
 4545 FORMAT(//,1X,'****USER-SPECIFIED SUMP BOILOVER POINT HAS BEEN REAC
     1HED****',//,5X,'TIME=',G12.5,//)    
      SUMM=0.D0
      DO 4547 KNP=1,15
      CALL INDEX(KNP,KJ)
      SUMM=SUMM+XBLT(KNP)/ROMLIQ(KJ)      
 4547 CONTINUE
      DO 4546 K=1,NSMP
      DO 5556 KV=1,NODES(K)     
      IF(NTYPMT(KV,K).LE.3) GO TO 5556    
      DO 5557 KTP=1,16
      CALL INDEX(KTP,KJ)
      RFAC=ROM(KJ)/ROMLIQ(KJ)   
      IF(KTP.EQ.16) RFAC=RSLAGS/RSLAGL    
      HITE(KTP,K)=HITE(KTP,K)+RFAC*HBMT(KV,K,KTP)   
      HBMT(KV,K,KTP)=0.D0
 5557 CONTINUE
 5556 CONTINUE
      DO 5559 KTP=1,15
      CALL INDEX(KTP,KJ)
      RFAC=ROM(KJ)/ROMLIQ(KJ)   
      HITE(KTP,K)=HITE(KTP,K)+XWTSS(KTP)*RFAC*THCKCV
      IF(XWTSS(KTP).GT.0.D0.AND.THCKCV.GT.0.D0) NTRACK(KTP)=1 
 5559 CONTINUE
      XDISTO(K)=XDCN(1)
      XBTWO(K)=XBCN(1)
      XDIST(1,K)=XDISTO(K)      
      XBTW(1,K)=XBTWO(K)
      ZABLAT(K)=XDISTO(K)
      ZABOLD(K)=ZABLAT(K)
      ELEVAT(K)=-ABS(ELSMP)     
      ELOLD(K)=ELEVAT(K)
      NPASSG(K)=0     
      NBCINT(K)=1     
      VEL(K+1)=0.D0   
      NODES(K)=NMVER  
      DO 9811 KGS=1,4 
      XLSMF(KGS,K)=0.D0
      NUMS(KGS,K)=1   
 9811 CONTINUE
      DO 7199 KV=1,NODES(K)     
      TEMP(KV,K)=TCONI
      NTYPMT(KV,K)=ICTYPE
      IF(NL(KV,K).EQ.2) GO TO 7354 
      ENTHP(KV,K)=EI  
      EMAX(KV,K)=EI   
      EOLD(KV,K)=EI   
      GO TO 7199
 7354 CONTINUE
      ENTHP(KV,K)=0.D0
      EMAX(KV,K)=0.D0
      EOLD(KV,K)=0.D0
 7199 CONTINUE
      HTOT(K)=0.D0    
      DO 4548 KTP=1,15
      CALL INDEX(KTP,KJ)
      HTMULT=(1.D0-VFINT)*ABS(ELSMP)      
      HITE(KTP,K)=(HTMULT*XBLT(KTP))/(ROMLIQ(KJ)*SUMM)+HITE(KTP,K)      
      HTOT(K)=HTOT(K)+HITE(KTP,K)
 4548 CONTINUE
      HTOT(K)=HTOT(K)+HITE(16,K)
      CALL ASINEA(HITE,K,HSEND,ROMLIQ,WPCC,WPM,WPA,WPCS,ROC,RSLAGL,0)   
      CALL ETF(ENBLK(K),HSEND,TEBOIL,DTDE)
      TBULK(K)=TEBOIL 
 4546 CONTINUE
      IF(ELSMP.NE.0.D0) NSUMP(NSMP+1)=1   
 1789 CONTINUE
      RETURN
      END